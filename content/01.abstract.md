## Abstract {.page_break_before}

The current reference genome is the backbone of diverse and rich annotations. 
Simple text formats, like VCF or BED, have been widely adopted and helped the critical exchange of genomic information. 
To enable similar enrichment for a pangenome reference, there is a dire need for tools and formats enabling pangenomic annotation. 
The Graph Alignment Format (GAF) is a text format, tab-delimitted like BED/VCF files, which was proposed to represent alignments.
While it could be used to represent any type of annotation in a pangenome graph, there is no tools to index and query them efficiently.

Here, we present extension to vg and HTSlib that provide efficient sorting, indexing and querying for GAF files.
With this approach, annotations overlapping a subgraph can be extracted quickly.
Paths are sorted based on the IDs of traversed nodes, compressed with BGZIP, and indexed with HTSlib/tabix that we extended to work with the GAF format. 
Compared to the GAM format, GAF files are easier to write text files and we show that they are twice as fast to sort and twice as small on disk.
In addition, we updated `vg annotate` to better produce graph annotations, as paths, starting from annotation files relative to linear references. 
More precisely, it can to take annotations in BED or GFF3 files, written relative to reference paths or haplotypes, and produce GAF files representing their paths through the pangenome.

We showcased these new commands on several applications. 
We projected annotations for all haplotypes in the latest draft human pangenome (HPRC v1.1 GRCh38-based Minigraph-Cactus pangenome), including genes, segmental duplications, tandem repeats and repeats annotations. 
We also projected known variants from the GWAS catalog and expression QTLs from the GTEx project to the pangenome. 
Finally, we reanalyzed ATAC-seq data from ENCODE to highlight how a coverage track could look like in a pangenome graph.
In all cases, these rich annotations can be quickly queried with `vg` and visualized using existing tools like the sequenceTubeMap or Bandage.


